apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: molam

resources:
  - namespace.yaml
  - sa-rbac.yaml
  - configmap.yaml
  - secrets-example.yaml
  - deployment-molam-id.yaml
  - deployment-notifications.yaml
  - deployment-translation.yaml
  - services.yaml
  - ingress.yaml
  - hpa.yaml
  - pdb.yaml
  - network-policy.yaml
  - servicemonitor.yaml

# Common labels
commonLabels:
  app.kubernetes.io/part-of: molam-platform
  app.kubernetes.io/managed-by: kustomize

# Image tag transformer
images:
  - name: ghcr.io/molam/molam-id
    newTag: latest
  - name: ghcr.io/molam/molam-notifications
    newTag: latest
  - name: ghcr.io/molam/molam-translation
    newTag: latest

# ConfigMap generator
configMapGenerator:
  - name: molam-config
    behavior: merge
    literals:
      - DEPLOYMENT_ENV=production
      - DEPLOYMENT_TIMESTAMP=$(date +%s)

# Namespace
namespace: molam
