# ============================================================================
# Brique 46 - Billing & Invoicing Marchands
# Environment Configuration
# ============================================================================

# ============================================================================
# Server Configuration
# ============================================================================
NODE_ENV=development
PORT=8046
CORS_ORIGIN=*

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
DATABASE_URL=postgresql://user:password@localhost:5432/molam_billing

# ============================================================================
# Molam ID Authentication (JWT RS256)
# ============================================================================
MOLAM_ID_JWT_PUBLIC="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END PUBLIC KEY-----"

# ============================================================================
# S3 Configuration (PDF Storage - WORM)
# ============================================================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
S3_BUCKET_INVOICES=molam-invoices-production

# Alternatively, use local file storage for development
USE_LOCAL_STORAGE=true
LOCAL_STORAGE_PATH=./storage/invoices

# ============================================================================
# PDF Generation
# ============================================================================
# Puppeteer configuration
PUPPETEER_EXECUTABLE_PATH=
# Leave empty to use bundled Chromium

# ============================================================================
# Billing Configuration
# ============================================================================
# Default payment terms (days)
DEFAULT_PAYMENT_TERMS=14

# Invoice generation schedule (cron expression)
MONTHLY_BILLING_CRON=0 0 1 * *  # 1st of month at midnight
WEEKLY_BILLING_CRON=0 0 * * 1   # Every Monday at midnight

# Off-cycle threshold (USD equivalent)
OFF_CYCLE_THRESHOLD_USD=500

# ============================================================================
# Treasury Integration
# ============================================================================
# Wallet service URL (Brique 33)
WALLET_SERVICE_URL=http://localhost:8033

# Treasury service URL (Brique 34-35)
TREASURY_SERVICE_URL=http://localhost:8034

# ============================================================================
# Webhooks Integration (Brique 45)
# ============================================================================
WEBHOOKS_SERVICE_URL=http://localhost:8045

# ============================================================================
# Security & Rate Limiting
# ============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=1000

# ============================================================================
# Logging & Monitoring
# ============================================================================
LOG_LEVEL=info
SENTRY_DSN=

# ============================================================================
# Development & Testing
# ============================================================================
# Skip JWT verification in development (DANGEROUS - only for local dev)
SKIP_JWT_VERIFICATION=false

# Mock external services
MOCK_WALLET_SERVICE=false
MOCK_TREASURY_SERVICE=false
MOCK_PDF_GENERATION=false
